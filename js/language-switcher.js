// Sistema de Multi-idioma
class LanguageManager {
    constructor() {
        this.currentLang = 'es';
        this.translations = {
            es: {
                // Navegaci√≥n
                'nav_main': 'Principal',
                'nav_creative': 'Creativo',
                'nav_tech': 'Tecnolog√≠a',
                'nav_gaming': 'Gaming',
                'nav_anime': 'Anime',
                'nav_global': 'Global',
                'nav_random': 'Random',
                'nav_void': 'Void',
                
                // Board Descriptions
                'global_description': 'Conversaciones globales en tiempo real',
                'random_description': 'Todo vale en el vac√≠o',
                'void_description': 'El vac√≠o absoluto',
                
                // Formulario
                'new_post': 'Nuevo Post',
                'name_placeholder': 'üï∂Ô∏è Nombre (opcional)',
                'subject_placeholder': 'üìå Asunto (opcional)',
                'message_placeholder': 'üí≠ Escribe tu mensaje aqu√≠...',
                'upload_image': 'üñºÔ∏è Subir imagen',
                'publish': 'üöÄ Publicar',
                'clear': 'üóëÔ∏è',
                'format_help': '‚ùì',
                'post_tips': 'Usa >>123 para citar',
                
                // Footer
                'footer_about': 'void chan',
                'footer_desc': 'Un foro an√≥nimo en la profundidad del vac√≠o digital',
                'footer_nav': 'Navegaci√≥n',
                'footer_games': 'Juegos',
                'footer_legal': 'Legal',
                
                // Juegos
                'game_snake': 'Snake',
                'game_tetris': 'Tetris',
                'game_miner': 'Void Miner',
                
                // General
                'site_title': 'void chan',
                'site_subtitle': 'donde el vac√≠o habla',
                'search_placeholder': 'Buscar en el vac√≠o...',
                'loading_posts': 'Cargando el vac√≠o...',
                'online_users': 'usuarios en l√≠nea',
                'total_posts': 'posts totales'
            },
            en: {
                'nav_main': 'Main',
                'nav_creative': 'Creative',
                'nav_tech': 'Technology',
                'nav_gaming': 'Gaming',
                'nav_anime': 'Anime',
                'nav_global': 'Global',
                'nav_random': 'Random',
                'nav_void': 'Void',
                
                'global_description': 'Real-time global conversations',
                'random_description': 'Anything goes in the void',
                'void_description': 'The absolute void',
                
                'new_post': 'New Post',
                'name_placeholder': 'üï∂Ô∏è Name (optional)',
                'subject_placeholder': 'üìå Subject (optional)',
                'message_placeholder': 'üí≠ Write your message here...',
                'upload_image': 'üñºÔ∏è Upload image',
                'publish': 'üöÄ Publish',
                'clear': 'üóëÔ∏è',
                'format_help': '‚ùì',
                'post_tips': 'Use >>123 to quote',
                
                'footer_about': 'void chan',
                'footer_desc': 'An anonymous forum in the depth of digital void',
                'footer_nav': 'Navigation',
                'footer_games': 'Games',
                'footer_legal': 'Legal',
                
                'game_snake': 'Snake',
                'game_tetris': 'Tetris',
                'game_miner': 'Void Miner',
                
                'site_title': 'void chan',
                'site_subtitle': 'where the void speaks',
                'search_placeholder': 'Search in the void...',
                'loading_posts': 'Loading the void...',
                'online_users': 'users online',
                'total_posts': 'total posts'
            },
            jp: {
                'nav_main': '„É°„Ç§„É≥',
                'nav_creative': '„ÇØ„É™„Ç®„Ç§„ÉÜ„Ç£„Éñ',
                'nav_tech': '„ÉÜ„ÇØ„Éé„É≠„Ç∏„Éº',
                'nav_gaming': '„Ç≤„Éº„É†',
                'nav_anime': '„Ç¢„Éã„É°',
                'nav_global': '„Ç∞„É≠„Éº„Éê„É´',
                'nav_random': '„É©„É≥„ÉÄ„É†',
                'nav_void': 'ËôöÁ©∫',
                
                'global_description': '„É™„Ç¢„É´„Çø„Ç§„É†„Ç∞„É≠„Éº„Éê„É´‰ºöË©±',
                'random_description': 'Ëôö„Åß„ÅØ‰Ωï„Åß„ÇÇ„ÅÇ„Çä',
                'void_description': 'Áµ∂ÂØæËôöÁ©∫',
                
                'new_post': 'Êñ∞Ë¶èÊäïÁ®ø',
                'name_placeholder': 'üï∂Ô∏è ÂêçÂâçÔºà‰ªªÊÑèÔºâ',
                'subject_placeholder': 'üìå ‰ª∂ÂêçÔºà‰ªªÊÑèÔºâ',
                'message_placeholder': 'üí≠ „Åì„Åì„Å´„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÊõ∏„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑ...',
                'upload_image': 'üñºÔ∏è ÁîªÂÉè„Çí„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ',
                'publish': 'üöÄ ÊäïÁ®ø',
                'clear': 'üóëÔ∏è',
                'format_help': '‚ùì',
                'post_tips': '>>123„ÅßÂºïÁî®„Åß„Åç„Åæ„Åô',
                
                'footer_about': 'void chan',
                'footer_desc': '„Éá„Ç∏„Çø„É´ËôöÁ©∫„ÅÆÊ∑±„Åø„Å´„ÅÇ„ÇãÂåøÂêç„Éï„Ç©„Éº„É©„É†',
                'footer_nav': '„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥',
                'footer_games': '„Ç≤„Éº„É†',
                'footer_legal': 'Ê≥ïÁöÑ',
                
                'game_snake': '„Çπ„Éç„Éº„ÇØ',
                'game_tetris': '„ÉÜ„Éà„É™„Çπ',
                'game_miner': 'ËôöÁ©∫Êé°Êéò',
                
                'site_title': 'void chan',
                'site_subtitle': 'ËôöÁ©∫„ÅåË™û„Çã„Å®„Åì„Çç',
                'search_placeholder': 'ËôöÁ©∫„ÅßÊ§úÁ¥¢...',
                'loading_posts': 'ËôöÁ©∫„ÇíË™≠„ÅøËæº„Åø‰∏≠...',
                'online_users': '„Ç™„É≥„É©„Ç§„É≥„É¶„Éº„Ç∂„Éº',
                'total_posts': 'Á∑èÊäïÁ®øÊï∞'
            },
            fr: {
                'nav_main': 'Principal',
                'nav_creative': 'Cr√©atif',
                'nav_tech': 'Technologie',
                'nav_gaming': 'Jeux',
                'nav_anime': 'Anime',
                'nav_global': 'Global',
                'nav_random': 'Al√©atoire',
                'nav_void': 'Vide',
                
                'global_description': 'Conversations globales en temps r√©el',
                'random_description': 'Tout est permis dans le vide',
                'void_description': 'Le vide absolu',
                
                'new_post': 'Nouveau Post',
                'name_placeholder': 'üï∂Ô∏è Nom (optionnel)',
                'subject_placeholder': 'üìå Sujet (optionnel)',
                'message_placeholder': 'üí≠ √âcrivez votre message ici...',
                'upload_image': 'üñºÔ∏è T√©l√©charger image',
                'publish': 'üöÄ Publier',
                'clear': 'üóëÔ∏è',
                'format_help': '‚ùì',
                'post_tips': 'Utilisez >>123 pour citer',
                
                'footer_about': 'void chan',
                'footer_desc': 'Un forum anonyme dans la profondeur du vide num√©rique',
                'footer_nav': 'Navigation',
                'footer_games': 'Jeux',
                'footer_legal': 'L√©gal',
                
                'game_snake': 'Snake',
                'game_tetris': 'Tetris',
                'game_miner': 'Mineur du Vide',
                
                'site_title': 'void chan',
                'site_subtitle': 'o√π le vide parle',
                'search_placeholder': 'Rechercher dans le vide...',
                'loading_posts': 'Chargement du vide...',
                'online_users': 'utilisateurs en ligne',
                'total_posts': 'posts totaux'
            }
        };
        
        this.init();
    }

    init() {
        this.loadSavedLanguage();
        this.setupEventListeners();
        this.applyLanguage(this.currentLang);
    }

    loadSavedLanguage() {
        const savedLang = localStorage.getItem('voidchan_language');
        if (savedLang && this.translations[savedLang]) {
            this.currentLang = savedLang;
        }
    }

    setupEventListeners() {
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const lang = e.target.dataset.lang;
                this.switchLanguage(lang);
            });
        });
    }

    switchLanguage(lang) {
        if (this.translations[lang]) {
            this.currentLang = lang;
            this.applyLanguage(lang);
            this.updateActiveButton(lang);
            this.saveLanguage(lang);
        }
    }

    applyLanguage(lang) {
        const elements = document.querySelectorAll('[data-i18n]');
        elements.forEach(element => {
            const key = element.getAttribute('data-i18n');
            if (this.translations[lang][key]) {
                if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                    element.placeholder = this.translations[lang][key];
                } else {
                    element.textContent = this.translations[lang][key];
                }
            }
        });

        // Actualizar textos din√°micos
        this.updateDynamicTexts(lang);
    }

    updateDynamicTexts(lang) {
        const onlineCount = document.getElementById('online-count');
        const postCount = document.getElementById('post-count');
        
        if (onlineCount) {
            const count = onlineCount.textContent.match(/\d+/);
            if (count) {
                onlineCount.textContent = `üåê ${count[0]} ${this.translations[lang]['online_users']}`;
            }
        }
        
        if (postCount) {
            const count = postCount.textContent.match(/\d+/);
            if (count) {
                postCount.textContent = `üìù ${count[0]} ${this.translations[lang]['total_posts']}`;
            }
        }
    }

    updateActiveButton(lang) {
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.classList.remove('active');
            if (btn.dataset.lang === lang) {
                btn.classList.add('active');
            }
        });
    }

    saveLanguage(lang) {
        localStorage.setItem('voidchan_language', lang);
    }

    getText(key) {
        return this.translations[this.currentLang][
